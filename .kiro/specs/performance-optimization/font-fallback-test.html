<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Font Fallback Test - Crowe Logic AI</title>
  <style>
    body {
      margin: 0;
      padding: 40px;
      background: #0a0a0a;
      color: #f2f2f2;
    }

    .test-section {
      margin-bottom: 60px;
      padding: 30px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 10px;
      color: #fff;
    }

    h2 {
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: #e0e0e0;
    }

    .description {
      margin-bottom: 20px;
      opacity: 0.8;
    }

    /* Inter font with fallback stack */
    .font-inter {
      font-family: "Inter", "Inter Fallback", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    /* System font only (fallback) */
    .font-system {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    /* Fira Code with fallback stack */
    .font-fira-code {
      font-family: "Fira Code", "Fira Code Fallback", ui-monospace, "SFMono-Regular", "SF Mono", Menlo, Monaco, "Cascadia Code", Consolas, "Liberation Mono", "Courier New", monospace;
    }

    /* Monospace fallback only */
    .font-monospace {
      font-family: ui-monospace, "SFMono-Regular", "SF Mono", Menlo, Monaco, "Cascadia Code", Consolas, "Liberation Mono", "Courier New", monospace;
    }

    .sample-text {
      padding: 20px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      margin-bottom: 15px;
      border-left: 3px solid #3b82f6;
    }

    .weight-400 { font-weight: 400; }
    .weight-600 { font-weight: 600; }
    .weight-700 { font-weight: 700; }

    .code-sample {
      padding: 20px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 8px;
      margin-bottom: 15px;
      border-left: 3px solid #10b981;
      font-size: 14px;
      line-height: 1.6;
    }

    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }

    .comparison-item {
      padding: 15px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      opacity: 0.6;
      margin-bottom: 10px;
    }

    .metrics {
      margin-top: 30px;
      padding: 20px;
      background: rgba(59, 130, 246, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    .metric-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .metric-item:last-child {
      border-bottom: none;
    }

    .pass {
      color: #10b981;
      font-weight: 600;
    }

    .info {
      color: #3b82f6;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <h1 class="font-inter">Font Fallback Stack Test</h1>
  <p class="description font-inter">
    This page tests the fallback font stacks for Inter and Fira Code to ensure minimal layout shift
    when fonts are loading or unavailable.
  </p>

  <!-- Inter Font Tests -->
  <div class="test-section">
    <h2 class="font-inter">Inter Font (Sans-Serif)</h2>
    
    <div class="sample-text font-inter weight-400">
      <strong>Weight 400 (Regular):</strong> The quick brown fox jumps over the lazy dog. 
      This is a sample of body text that would appear throughout the application.
      0123456789 !@#$%^&*()
    </div>

    <div class="sample-text font-inter weight-600">
      <strong>Weight 600 (Semi-Bold):</strong> The quick brown fox jumps over the lazy dog.
      This weight is used for emphasis and subheadings throughout the interface.
      0123456789 !@#$%^&*()
    </div>

    <div class="sample-text font-inter weight-700">
      <strong>Weight 700 (Bold):</strong> The quick brown fox jumps over the lazy dog.
      This weight is used for headings and important UI elements.
      0123456789 !@#$%^&*()
    </div>

    <div class="comparison">
      <div class="comparison-item">
        <div class="label">With Inter (if loaded)</div>
        <div class="font-inter" style="font-size: 16px; line-height: 1.5;">
          Master Mushroom Growing with AI<br>
          Optimize yields, prevent contamination<br>
          Real-time cultivation guidance
        </div>
      </div>
      <div class="comparison-item">
        <div class="label">Fallback (System Font)</div>
        <div class="font-system" style="font-size: 16px; line-height: 1.5;">
          Master Mushroom Growing with AI<br>
          Optimize yields, prevent contamination<br>
          Real-time cultivation guidance
        </div>
      </div>
    </div>

    <div class="metrics">
      <h3 style="margin-top: 0;">Inter Fallback Stack:</h3>
      <div class="metric-item">
        <span>Primary Font:</span>
        <span class="info">Inter</span>
      </div>
      <div class="metric-item">
        <span>Fallback 1:</span>
        <span class="pass">system-ui</span>
      </div>
      <div class="metric-item">
        <span>Fallback 2:</span>
        <span class="pass">-apple-system (macOS/iOS)</span>
      </div>
      <div class="metric-item">
        <span>Fallback 3:</span>
        <span class="pass">Segoe UI (Windows)</span>
      </div>
      <div class="metric-item">
        <span>Fallback 4:</span>
        <span class="pass">Roboto (Android)</span>
      </div>
      <div class="metric-item">
        <span>adjustFontFallback:</span>
        <span class="pass">Enabled ✓</span>
      </div>
    </div>
  </div>

  <!-- Fira Code Font Tests -->
  <div class="test-section">
    <h2 class="font-inter">Fira Code Font (Monospace)</h2>
    
    <div class="code-sample font-fira-code weight-400">
      <strong>Weight 400 (Regular):</strong><br>
      const optimizedFetch = async (url, options) => {<br>
      &nbsp;&nbsp;const response = await fetch(url, options);<br>
      &nbsp;&nbsp;return response.json();<br>
      };<br>
      // Arrow functions: => !== == <= >=
    </div>

    <div class="code-sample font-fira-code weight-500">
      <strong>Weight 500 (Medium):</strong><br>
      function calculateYield(substrate, conditions) {<br>
      &nbsp;&nbsp;return substrate.weight * conditions.efficiency;<br>
      }<br>
      // Ligatures: != === !== -> => <=
    </div>

    <div class="code-sample font-fira-code weight-600">
      <strong>Weight 600 (Semi-Bold):</strong><br>
      interface PerformanceMetric {<br>
      &nbsp;&nbsp;lcp: number; // Largest Contentful Paint<br>
      &nbsp;&nbsp;fid: number; // First Input Delay<br>
      }<br>
      // Terminal output: $ npm run build
    </div>

    <div class="comparison">
      <div class="comparison-item">
        <div class="label">With Fira Code (if loaded)</div>
        <div class="font-fira-code" style="font-size: 14px; line-height: 1.6;">
          npm install @crowe-logic/ai<br>
          const result = await api.fetch();<br>
          if (result !== null) { ... }<br>
          // Arrow: => != === !==
        </div>
      </div>
      <div class="comparison-item">
        <div class="label">Fallback (System Monospace)</div>
        <div class="font-monospace" style="font-size: 14px; line-height: 1.6;">
          npm install @crowe-logic/ai<br>
          const result = await api.fetch();<br>
          if (result !== null) { ... }<br>
          // Arrow: => != === !==
        </div>
      </div>
    </div>

    <div class="metrics">
      <h3 style="margin-top: 0;">Fira Code Fallback Stack:</h3>
      <div class="metric-item">
        <span>Primary Font:</span>
        <span class="info">Fira Code</span>
      </div>
      <div class="metric-item">
        <span>Fallback 1:</span>
        <span class="pass">ui-monospace</span>
      </div>
      <div class="metric-item">
        <span>Fallback 2:</span>
        <span class="pass">SFMono-Regular (macOS/iOS)</span>
      </div>
      <div class="metric-item">
        <span>Fallback 3:</span>
        <span class="pass">Cascadia Code (Windows Terminal)</span>
      </div>
      <div class="metric-item">
        <span>Fallback 4:</span>
        <span class="pass">Consolas (Windows)</span>
      </div>
      <div class="metric-item">
        <span>adjustFontFallback:</span>
        <span class="pass">Enabled ✓</span>
      </div>
    </div>
  </div>

  <!-- Layout Shift Test -->
  <div class="test-section">
    <h2 class="font-inter">Layout Shift Prevention</h2>
    <p class="description font-inter">
      The <code>adjustFontFallback</code> option automatically adjusts the size-adjust, ascent-override,
      descent-override, and line-gap-override properties of the fallback fonts to match the primary font's
      metrics. This minimizes Cumulative Layout Shift (CLS) when fonts load.
    </p>

    <div class="metrics">
      <h3 style="margin-top: 0;">Optimization Features:</h3>
      <div class="metric-item">
        <span>font-display: swap</span>
        <span class="pass">Enabled ✓</span>
      </div>
      <div class="metric-item">
        <span>Fallback font metrics adjustment</span>
        <span class="pass">Enabled ✓</span>
      </div>
      <div class="metric-item">
        <span>Platform-specific fallbacks</span>
        <span class="pass">Enabled ✓</span>
      </div>
      <div class="metric-item">
        <span>Preload critical fonts (Inter)</span>
        <span class="pass">Enabled ✓</span>
      </div>
      <div class="metric-item">
        <span>Lazy load non-critical fonts (Fira Code)</span>
        <span class="pass">Enabled ✓</span>
      </div>
    </div>
  </div>

  <script>
    // Log which fonts are actually being used
    document.fonts.ready.then(() => {
      console.log('Fonts loaded:', document.fonts.size);
      
      const interElement = document.querySelector('.font-inter');
      const firaElement = document.querySelector('.font-fira-code');
      
      if (interElement) {
        const interFont = window.getComputedStyle(interElement).fontFamily;
        console.log('Inter element using:', interFont);
      }
      
      if (firaElement) {
        const firaFont = window.getComputedStyle(firaElement).fontFamily;
        console.log('Fira Code element using:', firaFont);
      }
    });

    // Measure layout shift
    let clsScore = 0;
    const observer = new PerformanceObserver((list) => {
      for (const entry of list.getEntries()) {
        if (!entry.hadRecentInput) {
          clsScore += entry.value;
          console.log('Layout shift detected:', entry.value, 'Total CLS:', clsScore);
        }
      }
    });
    
    observer.observe({ type: 'layout-shift', buffered: true });
    
    // Report CLS after 5 seconds
    setTimeout(() => {
      console.log('Final CLS Score:', clsScore);
      if (clsScore < 0.1) {
        console.log('✓ CLS is GOOD (< 0.1)');
      } else if (clsScore < 0.25) {
        console.log('⚠ CLS needs improvement (0.1 - 0.25)');
      } else {
        console.log('✗ CLS is POOR (> 0.25)');
      }
    }, 5000);
  </script>
</body>
</html>
