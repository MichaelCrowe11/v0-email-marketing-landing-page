/* ===== MOBILE EXPERIENCE OPTIMIZATIONS ===== */

/* Touch Target Optimizations - Minimum 44x44px for all interactive elements */
@media (hover: none) and (pointer: coarse) {
  /* Ensure all interactive elements meet minimum touch target size */
  button,
  a[href],
  input[type="button"],
  input[type="submit"],
  input[type="reset"],
  [role="button"],
  [role="link"],
  [tabindex]:not([tabindex="-1"]) {
    min-height: 44px;
    min-width: 44px;
    padding: 0.75rem;
  }

  /* Larger tap targets for primary actions */
  .mobile-tap-target,
  .btn-primary,
  [data-primary="true"] {
    min-height: 48px;
    min-width: 48px;
  }

  /* Ensure form inputs are easily tappable */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="tel"],
  input[type="url"],
  input[type="number"],
  textarea,
  select {
    min-height: 44px;
    padding: 0.75rem 1rem;
  }

  /* Icon buttons need adequate spacing */
  button:has(svg:only-child),
  a:has(svg:only-child) {
    padding: 0.75rem;
  }
}

/* Touch Feedback - Ripple Effects */
.touch-ripple {
  position: relative;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
}

.touch-ripple::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s, opacity 0.6s;
  opacity: 0;
  pointer-events: none;
}

.touch-ripple:active::after {
  width: 200px;
  height: 200px;
  opacity: 1;
  transition: width 0s, height 0s, opacity 0s;
}

/* Dark mode ripple */
.dark .touch-ripple::after {
  background: rgba(255, 255, 255, 0.2);
}

/* Touch Feedback for Cards */
.touch-card {
  transition: transform 0.1s ease-out, box-shadow 0.1s ease-out;
  -webkit-tap-highlight-color: transparent;
}

.touch-card:active {
  transform: scale(0.98);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Gesture Support - Swipe Navigation */
.swipe-container {
  touch-action: pan-y;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-x: contain;
}

.swipe-item {
  scroll-snap-align: start;
  scroll-snap-stop: always;
}

/* Horizontal scroll with snap points */
.horizontal-scroll {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.horizontal-scroll::-webkit-scrollbar {
  display: none;
}

/* Form Input Optimizations */
@supports (-webkit-touch-callout: none) {
  /* iOS-specific input optimizations */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="tel"],
  input[type="url"],
  input[type="number"],
  textarea {
    /* Prevent zoom on focus - 16px minimum */
    font-size: 16px;
    /* Improve input appearance on iOS */
    -webkit-appearance: none;
    appearance: none;
    border-radius: 0.5rem;
  }

  /* Fix iOS input shadow */
  input,
  textarea,
  select {
    -webkit-appearance: none;
    appearance: none;
  }

  /* Improve select appearance */
  select {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 12px;
    padding-right: 2.5rem;
  }
}

/* Improve touch scrolling */
.mobile-scroll {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Prevent text selection on touch */
.no-select-touch {
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* Active state for touch */
.touch-active:active {
  opacity: 0.7;
  transform: scale(0.97);
}

/* Improve button touch feedback */
button,
[role="button"] {
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Prevent double-tap zoom on buttons */
button,
a,
[role="button"],
[role="link"] {
  touch-action: manipulation;
}

/* Improve link touch targets */
a {
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
}

.dark a {
  -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
}

/* Mobile-specific spacing adjustments */
@media (max-width: 768px) {
  /* Increase spacing between interactive elements */
  .mobile-stack > * + * {
    margin-top: 1rem;
  }

  /* Improve button spacing */
  .mobile-button-group {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .mobile-button-group button,
  .mobile-button-group a {
    width: 100%;
  }
}

/* Keyboard type hints for better mobile UX */
/* Note: inputmode is an HTML attribute, not a CSS property */
/* Add inputmode="email", inputmode="tel", inputmode="numeric", etc. directly to HTML input elements */
/* This provides better mobile keyboard experiences by showing appropriate keyboards */

/* Improve checkbox and radio button touch targets */
input[type="checkbox"],
input[type="radio"] {
  min-width: 24px;
  min-height: 24px;
  cursor: pointer;
}

/* Custom checkbox/radio with larger touch area */
.touch-checkbox,
.touch-radio {
  position: relative;
  display: inline-flex;
  align-items: center;
  min-height: 44px;
  padding: 0.5rem;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}

.touch-checkbox input,
.touch-radio input {
  position: absolute;
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}

/* Improve slider touch targets */
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  height: 44px;
  background: transparent;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--primary);
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

input[type="range"]::-moz-range-thumb {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--primary);
  cursor: pointer;
  border: none;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* Improve toggle switch touch targets */
.touch-toggle {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
  min-height: 44px;
  display: flex;
  align-items: center;
}

.touch-toggle input {
  opacity: 0;
  width: 0;
  height: 0;
}

.touch-toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 50%;
  transform: translateY(-50%);
  left: 0;
  right: 0;
  height: 34px;
  background-color: var(--muted);
  transition: 0.3s;
  border-radius: 34px;
}

.touch-toggle-slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: 0.3s;
  border-radius: 50%;
}

.touch-toggle input:checked + .touch-toggle-slider {
  background-color: var(--primary);
}

.touch-toggle input:checked + .touch-toggle-slider:before {
  transform: translateX(26px);
}

/* Pull-to-refresh indicator */
.pull-to-refresh {
  position: relative;
  overflow: hidden;
}

.pull-to-refresh-indicator {
  position: absolute;
  top: -60px;
  left: 50%;
  transform: translateX(-50%);
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: top 0.3s ease;
}

.pull-to-refresh.pulling .pull-to-refresh-indicator {
  top: 10px;
}

/* Improve modal/dialog touch interactions */
.mobile-modal {
  touch-action: none;
}

.mobile-modal-overlay {
  -webkit-tap-highlight-color: transparent;
}

/* Improve dropdown touch targets */
.mobile-dropdown-item {
  min-height: 48px;
  display: flex;
  align-items: center;
  padding: 0.75rem 1rem;
  -webkit-tap-highlight-color: transparent;
}

/* Improve tab touch targets */
.mobile-tab {
  min-height: 48px;
  min-width: 80px;
  padding: 0.75rem 1.5rem;
  -webkit-tap-highlight-color: transparent;
}

/* Improve pagination touch targets */
.mobile-pagination-button {
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Floating Action Button (FAB) for mobile */
.mobile-fab {
  position: fixed;
  bottom: 24px;
  right: 24px;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 40;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

.mobile-fab:active {
  transform: scale(0.95);
}

/* Bottom sheet for mobile */
.mobile-bottom-sheet {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--background);
  border-top-left-radius: 1.5rem;
  border-top-right-radius: 1.5rem;
  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
  transform: translateY(100%);
  transition: transform 0.3s ease;
  z-index: 50;
  max-height: 90vh;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.mobile-bottom-sheet.open {
  transform: translateY(0);
}

.mobile-bottom-sheet-handle {
  width: 40px;
  height: 4px;
  background: var(--muted-foreground);
  border-radius: 2px;
  margin: 12px auto;
  opacity: 0.5;
}

/* Improve card touch interactions */
.mobile-card-interactive {
  transition: transform 0.1s ease, box-shadow 0.1s ease;
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
}

.mobile-card-interactive:active {
  transform: scale(0.98);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Improve list item touch targets */
.mobile-list-item {
  min-height: 56px;
  display: flex;
  align-items: center;
  padding: 1rem;
  -webkit-tap-highlight-color: transparent;
  border-bottom: 1px solid var(--border);
}

.mobile-list-item:active {
  background: var(--accent);
}

/* Sticky header for mobile */
.mobile-sticky-header {
  position: sticky;
  top: 0;
  z-index: 30;
  background: var(--background);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
}

/* Sticky CTA for mobile */
.mobile-sticky-cta {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 1rem;
  background: var(--background);
  border-top: 1px solid var(--border);
  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05);
  z-index: 30;
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

@supports (padding: max(0px)) {
  .mobile-sticky-cta {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }
}

/* Improve swipe gestures */
.swipeable {
  touch-action: pan-y;
  user-select: none;
  -webkit-user-select: none;
}

.swipeable-item {
  transition: transform 0.3s ease;
}

/* Haptic feedback simulation */
@media (hover: none) and (pointer: coarse) {
  .haptic-light:active {
    animation: haptic-pulse 0.1s ease;
  }
}

@keyframes haptic-pulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(0.98);
  }
}

/* Improve touch scrolling momentum */
.momentum-scroll {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
  overscroll-behavior-y: contain;
}

/* Prevent overscroll bounce on specific elements */
.no-overscroll {
  overscroll-behavior: none;
}

/* Improve touch drag interactions */
.touch-draggable {
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
  cursor: grab;
}

.touch-draggable:active {
  cursor: grabbing;
}

/* Mobile-optimized tooltips */
@media (hover: none) and (pointer: coarse) {
  /* Hide hover-only tooltips on touch devices */
  .tooltip-hover {
    display: none;
  }

  /* Show tap-to-reveal tooltips */
  .tooltip-touch {
    display: block;
  }
}

/* Improve mobile menu interactions */
.mobile-menu-item {
  min-height: 52px;
  display: flex;
  align-items: center;
  padding: 0.875rem 1rem;
  -webkit-tap-highlight-color: transparent;
  transition: background-color 0.15s ease;
}

.mobile-menu-item:active {
  background-color: var(--accent);
}

/* Mobile-optimized accordion */
.mobile-accordion-trigger {
  min-height: 56px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem;
  -webkit-tap-highlight-color: transparent;
}

/* Improve mobile search */
.mobile-search-input {
  min-height: 48px;
  padding: 0.75rem 1rem;
  font-size: 16px; /* Prevent iOS zoom */
  border-radius: 24px;
}

/* Mobile-optimized chip/tag */
.mobile-chip {
  min-height: 36px;
  padding: 0.5rem 1rem;
  border-radius: 18px;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  -webkit-tap-highlight-color: transparent;
}

.mobile-chip-close {
  min-width: 24px;
  min-height: 24px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

/* Improve mobile date/time picker */
input[type="date"],
input[type="time"],
input[type="datetime-local"] {
  min-height: 48px;
  padding: 0.75rem 1rem;
  font-size: 16px;
}

/* Mobile-optimized badge */
.mobile-badge {
  min-width: 24px;
  min-height: 24px;
  padding: 0.25rem 0.5rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
}

/* Improve mobile avatar touch targets */
.mobile-avatar {
  min-width: 44px;
  min-height: 44px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Mobile-optimized progress bar */
.mobile-progress {
  height: 8px;
  border-radius: 4px;
  overflow: hidden;
  background: var(--muted);
}

.mobile-progress-bar {
  height: 100%;
  background: var(--primary);
  transition: width 0.3s ease;
}

/* Improve mobile skeleton loading */
.mobile-skeleton {
  min-height: 20px;
  background: linear-gradient(
    90deg,
    var(--muted) 0%,
    var(--accent) 50%,
    var(--muted) 100%
  );
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
  border-radius: 0.5rem;
}

@keyframes skeleton-loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Mobile-optimized empty state */
.mobile-empty-state {
  min-height: 200px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 2rem 1rem;
  text-align: center;
}

/* Improve mobile notification/toast */
.mobile-toast {
  min-height: 56px;
  padding: 1rem;
  border-radius: 0.75rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  -webkit-tap-highlight-color: transparent;
}

/* Mobile-optimized stepper */
.mobile-stepper-item {
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
}

/* Improve mobile carousel/slider */
.mobile-carousel {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
  gap: 1rem;
  padding: 1rem;
}

.mobile-carousel::-webkit-scrollbar {
  display: none;
}

.mobile-carousel-item {
  flex: 0 0 85%;
  scroll-snap-align: center;
  scroll-snap-stop: always;
}

@media (min-width: 640px) {
  .mobile-carousel-item {
    flex: 0 0 45%;
  }
}

@media (min-width: 1024px) {
  .mobile-carousel-item {
    flex: 0 0 30%;
  }
}

/* Mobile-optimized grid */
.mobile-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
}

@media (min-width: 640px) {
  .mobile-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 1024px) {
  .mobile-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

/* Improve mobile video player controls */
.mobile-video-control {
  min-width: 48px;
  min-height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  -webkit-tap-highlight-color: transparent;
}

/* Mobile-optimized breadcrumb */
.mobile-breadcrumb-item {
  min-height: 36px;
  display: inline-flex;
  align-items: center;
  padding: 0.5rem 0.75rem;
  -webkit-tap-highlight-color: transparent;
}

/* Improve mobile color picker */
.mobile-color-swatch {
  min-width: 44px;
  min-height: 44px;
  border-radius: 0.5rem;
  border: 2px solid var(--border);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
}

.mobile-color-swatch:active {
  transform: scale(0.95);
}

/* ===== MOBILE PERFORMANCE ENHANCEMENTS ===== */

/* CSS Containment for better rendering performance */
.mobile-contain-layout {
  contain: layout;
}

.mobile-contain-paint {
  contain: paint;
}

.mobile-contain-strict {
  contain: strict;
}

.mobile-contain-content {
  contain: content;
}

/* Reduce animation complexity on mobile */
@media (max-width: 768px) {
  /* Simplify animations for better performance */
  .animate-spin-slow {
    animation-duration: 6s; /* Slower = less CPU */
  }

  .animate-pulse {
    animation-duration: 3s; /* Slower pulse */
  }

  /* Disable complex animations on mobile */
  .mobile-disable-animation {
    animation: none !important;
    transition: none !important;
  }

  /* Reduce blur effects on mobile for better performance */
  .backdrop-blur-2xl,
  .backdrop-blur-3xl {
    backdrop-filter: blur(12px) !important;
    -webkit-backdrop-filter: blur(12px) !important;
  }

  .backdrop-blur-xl {
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
  }

  /* Optimize shadows on mobile */
  .shadow-2xl,
  .shadow-xl {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
  }

  /* Reduce gradient complexity */
  .bg-gradient-to-br,
  .bg-gradient-to-r,
  .bg-gradient-to-b {
    background-image: none !important;
    background-color: var(--background) !important;
  }
}

/* Lazy loading optimization */
.lazy-load {
  content-visibility: auto;
  contain-intrinsic-size: 0 500px;
}

/* Optimize images for mobile */
@media (max-width: 768px) {
  img {
    /* Enable hardware acceleration */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    
    /* Optimize image rendering */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }

  /* Lazy load images below the fold */
  img[loading="lazy"] {
    content-visibility: auto;
  }
}

/* Optimize video for mobile */
@media (max-width: 768px) {
  video {
    /* Reduce video quality on mobile */
    max-width: 100%;
    height: auto;
    
    /* Enable hardware acceleration */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
}

/* Reduce motion for better mobile performance */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Optimize scrolling performance */
.mobile-scroll-optimized {
  -webkit-overflow-scrolling: touch;
  overflow-y: auto;
  overscroll-behavior-y: contain;
  
  /* Enable GPU acceleration */
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  will-change: scroll-position;
}

/* Optimize list rendering */
.mobile-list-optimized {
  contain: layout style paint;
  content-visibility: auto;
}

.mobile-list-item-optimized {
  contain: layout style;
  content-visibility: auto;
  contain-intrinsic-size: 0 60px;
}

/* Optimize grid rendering */
.mobile-grid-optimized {
  contain: layout style;
  content-visibility: auto;
}

/* Optimize card rendering */
.mobile-card-optimized {
  contain: layout style paint;
  content-visibility: auto;
  contain-intrinsic-size: 0 200px;
}

/* Optimize modal/dialog rendering */
.mobile-modal-optimized {
  contain: layout style paint;
  will-change: transform, opacity;
}

/* Optimize hero section for mobile */
@media (max-width: 768px) {
  .hero-section-mobile {
    /* Reduce particle count handled in JS */
    /* Simplify background effects */
    background-image: none !important;
  }

  /* Optimize code particles */
  .code-particle-mobile {
    will-change: transform;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
}

/* Optimize terminal for mobile */
@media (max-width: 768px) {
  .terminal-mobile-optimized {
    /* Reduce blur for better performance */
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
    
    /* Simplify shadows */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }

  /* Optimize terminal text rendering */
  .terminal-text-mobile {
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: subpixel-antialiased;
  }
}

/* Optimize chat demo for mobile */
@media (max-width: 768px) {
  .chat-demo-mobile-optimized {
    /* Reduce blur effects */
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
    
    /* Simplify animations */
    animation-duration: 0.2s !important;
  }

  /* Optimize phone mockup */
  .phone-mockup-mobile {
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    will-change: transform;
  }
}

/* Optimize pricing cards for mobile */
@media (max-width: 768px) {
  .pricing-card-mobile-optimized {
    contain: layout style paint;
    content-visibility: auto;
    contain-intrinsic-size: 0 400px;
    
    /* Simplify hover effects */
    transition: transform 0.2s ease !important;
  }

  .pricing-card-mobile-optimized:hover {
    transform: none !important;
  }
}

/* Optimize feature cards for mobile */
@media (max-width: 768px) {
  .feature-card-mobile-optimized {
    contain: layout style paint;
    content-visibility: auto;
    contain-intrinsic-size: 0 300px;
  }

  /* Simplify feature card animations */
  .feature-card-mobile-optimized:hover {
    transform: none !important;
  }
}

/* Network-aware optimizations */
@media (prefers-reduced-data: reduce) {
  /* Reduce data usage for slow connections */
  img {
    /* Disable high-res images */
    image-rendering: pixelated;
  }

  /* Disable background images */
  .bg-gradient-to-br,
  .bg-gradient-to-r,
  .bg-gradient-to-b {
    background-image: none !important;
  }

  /* Disable animations */
  * {
    animation: none !important;
    transition: none !important;
  }
}

/* Optimize font loading for mobile */
@media (max-width: 768px) {
  /* Use system fonts as fallback for faster loading */
  body {
    font-display: swap;
  }

  /* Optimize code font loading */
  .font-mono,
  .font-code {
    font-display: swap;
  }
}

/* Optimize form inputs for mobile */
@media (max-width: 768px) {
  input,
  textarea,
  select {
    /* Optimize rendering */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    
    /* Reduce shadows */
    box-shadow: none !important;
  }

  /* Optimize focus states */
  input:focus,
  textarea:focus,
  select:focus {
    box-shadow: 0 0 0 2px var(--ring) !important;
  }
}

/* Optimize button rendering for mobile */
@media (max-width: 768px) {
  button,
  [role="button"] {
    /* Enable hardware acceleration */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    
    /* Simplify transitions */
    transition: background-color 0.2s ease, opacity 0.2s ease !important;
  }

  /* Simplify button hover effects */
  button:hover,
  [role="button"]:hover {
    transform: none !important;
    box-shadow: none !important;
  }

  /* Optimize active state */
  button:active,
  [role="button"]:active {
    transform: scale(0.98) !important;
  }
}

/* Optimize navigation for mobile */
@media (max-width: 768px) {
  nav {
    contain: layout style;
    will-change: transform;
  }

  /* Optimize sidebar */
  .sidebar-mobile-optimized {
    contain: layout style paint;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }

  /* Optimize header */
  .header-mobile-optimized {
    contain: layout style;
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
  }
}

/* Optimize modal/overlay for mobile */
@media (max-width: 768px) {
  .modal-overlay-mobile {
    backdrop-filter: blur(4px) !important;
    -webkit-backdrop-filter: blur(4px) !important;
  }

  .modal-content-mobile {
    contain: layout style paint;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
}

/* Optimize dropdown for mobile */
@media (max-width: 768px) {
  .dropdown-mobile-optimized {
    contain: layout style paint;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }
}

/* Optimize tooltip for mobile */
@media (max-width: 768px) {
  .tooltip-mobile-optimized {
    contain: layout style paint;
    backdrop-filter: blur(4px) !important;
    -webkit-backdrop-filter: blur(4px) !important;
  }
}

/* Optimize accordion for mobile */
@media (max-width: 768px) {
  .accordion-mobile-optimized {
    contain: layout style;
  }

  .accordion-content-mobile {
    content-visibility: auto;
  }
}

/* Optimize tabs for mobile */
@media (max-width: 768px) {
  .tabs-mobile-optimized {
    contain: layout style;
  }

  .tab-content-mobile {
    content-visibility: auto;
    contain-intrinsic-size: 0 300px;
  }
}

/* Optimize carousel for mobile */
@media (max-width: 768px) {
  .carousel-mobile-optimized {
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x mandatory;
    overscroll-behavior-x: contain;
    
    /* Enable GPU acceleration */
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
  }

  .carousel-item-mobile {
    scroll-snap-align: center;
    scroll-snap-stop: always;
    contain: layout style paint;
  }
}

/* Optimize infinite scroll for mobile */
.infinite-scroll-mobile {
  content-visibility: auto;
  contain-intrinsic-size: 0 500px;
}

/* Optimize skeleton loading for mobile */
@media (max-width: 768px) {
  .skeleton-mobile-optimized {
    /* Simplify animation */
    animation-duration: 2s !important;
    background-size: 100% 100% !important;
  }
}

/* Optimize loading spinner for mobile */
@media (max-width: 768px) {
  .spinner-mobile-optimized {
    /* Simplify animation */
    animation-duration: 1s !important;
  }
}

/* Performance monitoring utilities */
.perf-monitor {
  /* Add visual indicator for performance issues */
  position: fixed;
  bottom: 10px;
  right: 10px;
  padding: 8px 12px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
  font-size: 12px;
  font-family: monospace;
  border-radius: 4px;
  z-index: 9999;
  pointer-events: none;
}

/* Critical CSS for above-the-fold content */
.critical-content {
  /* Ensure critical content renders immediately */
  contain: none;
  content-visibility: visible;
}

/* Below-the-fold lazy loading */
.below-fold {
  content-visibility: auto;
  contain-intrinsic-size: 0 500px;
}

/* Optimize for low-end devices */
@media (max-width: 768px) and (max-resolution: 1dppx) {
  /* Further reduce effects on low-end devices */
  .backdrop-blur-xl,
  .backdrop-blur-2xl,
  .backdrop-blur-3xl {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background-color: var(--background) !important;
  }

  /* Disable all animations */
  * {
    animation: none !important;
  }

  /* Simplify shadows */
  .shadow-xl,
  .shadow-2xl,
  .shadow-lg {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
  }
}

/* ===== iOS-SPECIFIC FIXES ===== */

/* Prevent unwanted zoom on input focus - 16px minimum font size */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari specific */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="tel"],
  input[type="url"],
  input[type="number"],
  input[type="date"],
  input[type="time"],
  input[type="datetime-local"],
  textarea,
  select {
    font-size: 16px !important;
  }

  /* Ensure buttons also have 16px minimum */
  button,
  [role="button"] {
    font-size: 16px;
  }

  /* Prevent zoom on small text */
  .text-xs,
  .text-sm {
    font-size: 16px !important;
  }
}

/* Handle safe area insets for notched devices (iPhone X and later) */
@supports (padding: max(0px)) {
  /* Apply safe area insets to body */
  body {
    padding-top: max(0px, env(safe-area-inset-top));
    padding-bottom: max(0px, env(safe-area-inset-bottom));
    padding-left: max(0px, env(safe-area-inset-left));
    padding-right: max(0px, env(safe-area-inset-right));
  }

  /* Apply safe area insets to fixed header */
  .mobile-sticky-header,
  .header-mobile-optimized {
    padding-top: max(1rem, env(safe-area-inset-top));
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  /* Apply safe area insets to fixed footer/CTA */
  .mobile-sticky-cta {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  /* Apply safe area insets to sidebar */
  .sidebar-mobile-optimized {
    padding-top: max(1rem, env(safe-area-inset-top));
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
    padding-left: max(1rem, env(safe-area-inset-left));
  }

  /* Apply safe area insets to modal */
  .modal-content-mobile {
    padding-top: max(1rem, env(safe-area-inset-top));
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  /* Apply safe area insets to bottom sheet */
  .mobile-bottom-sheet {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  /* Apply safe area insets to FAB */
  .mobile-fab {
    bottom: max(24px, calc(24px + env(safe-area-inset-bottom)));
    right: max(24px, calc(24px + env(safe-area-inset-right)));
  }

  /* Apply safe area insets to toast notifications */
  .mobile-toast {
    margin-bottom: max(1rem, env(safe-area-inset-bottom));
    margin-left: max(1rem, env(safe-area-inset-left));
    margin-right: max(1rem, env(safe-area-inset-right));
  }
}

/* Fix iOS input focus behavior */
@supports (-webkit-touch-callout: none) {
  /* Prevent iOS from adding default styling */
  input,
  textarea,
  select,
  button {
    -webkit-appearance: none;
    appearance: none;
  }

  /* Fix iOS input shadow */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="tel"],
  input[type="url"],
  input[type="number"],
  textarea {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 0.5rem;
    background-color: var(--input);
    border: 1px solid var(--border);
  }

  /* Fix iOS select appearance */
  select {
    -webkit-appearance: none;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 12px;
    padding-right: 2.5rem;
  }

  /* Fix iOS button appearance */
  button,
  [role="button"] {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 0.5rem;
  }

  /* Fix iOS checkbox and radio appearance */
  input[type="checkbox"],
  input[type="radio"] {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    border: 2px solid var(--border);
    border-radius: 4px;
    background-color: var(--background);
    position: relative;
    cursor: pointer;
  }

  input[type="radio"] {
    border-radius: 50%;
  }

  input[type="checkbox"]:checked::after {
    content: "âœ“";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: var(--primary-foreground);
    font-size: 16px;
    font-weight: bold;
  }

  input[type="checkbox"]:checked {
    background-color: var(--primary);
    border-color: var(--primary);
  }

  input[type="radio"]:checked::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background-color: var(--primary-foreground);
  }

  input[type="radio"]:checked {
    background-color: var(--primary);
    border-color: var(--primary);
  }

  /* Fix iOS range slider appearance */
  input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 44px;
    background: transparent;
    cursor: pointer;
  }

  input[type="range"]::-webkit-slider-track {
    width: 100%;
    height: 8px;
    background: var(--muted);
    border-radius: 4px;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    margin-top: -8px;
  }

  /* Fix iOS date/time picker appearance */
  input[type="date"],
  input[type="time"],
  input[type="datetime-local"] {
    -webkit-appearance: none;
    appearance: none;
    min-height: 48px;
    padding: 0.75rem 1rem;
    font-size: 16px;
    border-radius: 0.5rem;
    background-color: var(--input);
    border: 1px solid var(--border);
  }

  /* Fix iOS color picker appearance */
  input[type="color"] {
    -webkit-appearance: none;
    appearance: none;
    width: 44px;
    height: 44px;
    border: 2px solid var(--border);
    border-radius: 0.5rem;
    cursor: pointer;
  }

  input[type="color"]::-webkit-color-swatch-wrapper {
    padding: 0;
  }

  input[type="color"]::-webkit-color-swatch {
    border: none;
    border-radius: 0.375rem;
  }
}

/* Fix iOS scroll behavior */
@supports (-webkit-touch-callout: none) {
  /* Fix momentum scrolling */
  body,
  .mobile-scroll,
  .mobile-scroll-optimized {
    -webkit-overflow-scrolling: touch;
  }

  /* Fix iOS rubber band effect */
  body {
    overscroll-behavior-y: none;
  }

  /* Fix iOS scroll position on orientation change */
  @media (orientation: landscape) {
    body {
      height: 100vh;
      height: -webkit-fill-available;
    }
  }

  @media (orientation: portrait) {
    body {
      height: 100vh;
      height: -webkit-fill-available;
    }
  }
}

/* Fix iOS viewport height issues */
@supports (-webkit-touch-callout: none) {
  /* Use -webkit-fill-available for iOS */
  .min-h-screen {
    min-height: 100vh;
    min-height: -webkit-fill-available;
  }

  .h-screen {
    height: 100vh;
    height: -webkit-fill-available;
  }

  /* Fix iOS modal height */
  .modal-content-mobile {
    max-height: 90vh;
    max-height: calc(-webkit-fill-available * 0.9);
  }

  /* Fix iOS bottom sheet height */
  .mobile-bottom-sheet {
    max-height: 90vh;
    max-height: calc(-webkit-fill-available * 0.9);
  }
}

/* Fix iOS tap highlight */
@supports (-webkit-touch-callout: none) {
  /* Remove default tap highlight */
  * {
    -webkit-tap-highlight-color: transparent;
  }

  /* Add custom tap highlight for interactive elements */
  a,
  button,
  [role="button"],
  [role="link"] {
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
  }

  .dark a,
  .dark button,
  .dark [role="button"],
  .dark [role="link"] {
    -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
  }
}

/* Fix iOS text selection */
@supports (-webkit-touch-callout: none) {
  /* Improve text selection on iOS */
  ::selection {
    background-color: var(--primary);
    color: var(--primary-foreground);
  }

  /* Disable text selection on UI elements */
  button,
  [role="button"],
  .no-select-touch {
    -webkit-user-select: none;
    user-select: none;
  }

  /* Enable text selection on content */
  p,
  span,
  div,
  article,
  section {
    -webkit-user-select: text;
    user-select: text;
  }
}

/* Fix iOS font rendering */
@supports (-webkit-touch-callout: none) {
  /* Improve font rendering on iOS */
  body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }

  /* Fix iOS font weight rendering */
  strong,
  b {
    font-weight: 600;
  }

  /* Fix iOS code font rendering */
  code,
  pre,
  .font-mono,
  .font-code {
    -webkit-font-smoothing: subpixel-antialiased;
  }
}

/* Fix iOS backdrop filter */
@supports (-webkit-touch-callout: none) {
  /* Ensure backdrop filter works on iOS */
  .backdrop-blur-xl,
  .backdrop-blur-2xl,
  .backdrop-blur-3xl {
    -webkit-backdrop-filter: blur(20px);
    backdrop-filter: blur(20px);
  }

  .backdrop-blur-lg {
    -webkit-backdrop-filter: blur(16px);
    backdrop-filter: blur(16px);
  }

  .backdrop-blur-md {
    -webkit-backdrop-filter: blur(12px);
    backdrop-filter: blur(12px);
  }

  .backdrop-blur-sm {
    -webkit-backdrop-filter: blur(8px);
    backdrop-filter: blur(8px);
  }

  /* Fix iOS glass effects */
  .glass-panel,
  .glass-card,
  .glass-button,
  .glass-terminal,
  .glass-phone {
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    backdrop-filter: blur(20px) saturate(180%);
  }
}

/* Fix iOS animation performance */
@supports (-webkit-touch-callout: none) {
  /* Enable hardware acceleration on iOS */
  .animate-spin,
  .animate-spin-slow,
  .animate-pulse,
  .animate-bounce {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    will-change: transform;
  }

  /* Optimize iOS animations */
  @media (max-width: 768px) {
    .animate-spin-slow {
      animation-duration: 6s;
    }

    .animate-pulse {
      animation-duration: 3s;
    }
  }
}

/* Fix iOS sticky positioning */
@supports (-webkit-touch-callout: none) {
  /* Ensure sticky positioning works on iOS */
  .sticky,
  .mobile-sticky-header,
  .mobile-sticky-cta {
    position: -webkit-sticky;
    position: sticky;
  }
}

/* Fix iOS flexbox issues */
@supports (-webkit-touch-callout: none) {
  /* Fix iOS flexbox min-height bug */
  .flex,
  .inline-flex {
    min-height: 0;
    min-width: 0;
  }

  /* Fix iOS flex shrink */
  .flex-shrink-0 {
    flex-shrink: 0;
    -webkit-flex-shrink: 0;
  }

  .flex-grow {
    flex-grow: 1;
    -webkit-flex-grow: 1;
  }
}

/* Fix iOS grid issues */
@supports (-webkit-touch-callout: none) {
  /* Fix iOS grid auto-fit */
  .grid {
    display: -ms-grid;
    display: grid;
  }
}

/* Fix iOS transform issues */
@supports (-webkit-touch-callout: none) {
  /* Ensure transforms work on iOS */
  .transform {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }

  /* Fix iOS 3D transforms */
  .perspective-1000 {
    -webkit-perspective: 1000px;
    perspective: 1000px;
  }

  .perspective-2000 {
    -webkit-perspective: 2000px;
    perspective: 2000px;
  }
}

/* Fix iOS transition issues */
@supports (-webkit-touch-callout: none) {
  /* Ensure transitions work smoothly on iOS */
  .transition {
    -webkit-transition: all 0.3s ease;
    transition: all 0.3s ease;
  }

  .transition-transform {
    -webkit-transition: -webkit-transform 0.3s ease;
    transition: transform 0.3s ease;
  }

  .transition-opacity {
    -webkit-transition: opacity 0.3s ease;
    transition: opacity 0.3s ease;
  }
}

/* Fix iOS modal/dialog issues */
@supports (-webkit-touch-callout: none) {
  /* Prevent body scroll when modal is open */
  body.modal-open {
    position: fixed;
    width: 100%;
    overflow: hidden;
  }

  /* Fix iOS modal backdrop */
  .modal-overlay-mobile {
    position: fixed;
    inset: 0;
    -webkit-backdrop-filter: blur(4px);
    backdrop-filter: blur(4px);
  }
}

/* Fix iOS video playback */
@supports (-webkit-touch-callout: none) {
  /* Note: playsinline is an HTML attribute, not CSS property */
  /* Add playsinline attribute to video elements in HTML */
  
  /* Fix iOS video controls */
  video::-webkit-media-controls {
    display: flex !important;
  }
}

/* Fix iOS audio playback */
@supports (-webkit-touch-callout: none) {
  /* Note: playsinline is an HTML attribute, not CSS property */
  /* Add playsinline attribute to audio elements in HTML */
  
  audio {
    width: 100%;
  }
}

/* Fix iOS image rendering */
@supports (-webkit-touch-callout: none) {
  /* Optimize image rendering on iOS */
  img {
    -webkit-user-select: none;
    user-select: none;
  }

  /* Fix iOS image aspect ratio */
  img {
    max-width: 100%;
    height: auto;
  }
}

/* Fix iOS SVG rendering */
@supports (-webkit-touch-callout: none) {
  /* Optimize SVG rendering on iOS */
  svg {
    max-width: 100%;
    height: auto;
  }

  /* Fix iOS SVG transform */
  svg {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
}

/* Fix iOS canvas rendering */
@supports (-webkit-touch-callout: none) {
  /* Optimize canvas rendering on iOS */
  canvas {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
}

/* Fix iOS iframe rendering */
@supports (-webkit-touch-callout: none) {
  /* Optimize iframe rendering on iOS */
  iframe {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }

  /* Fix iOS iframe scrolling */
  iframe {
    -webkit-overflow-scrolling: touch;
  }
}

/* Test on various iOS versions */
/* Note: These selectors are placeholders for future iOS-specific fixes */
/* iOS 12+ - All core fixes above are compatible with iOS 12+ */
/* iOS 13+ - Dark mode support is handled by prefers-color-scheme */
/* iOS 14+ - All fixes are compatible with iOS 14+ */
/* iOS 15+ - All fixes are compatible with iOS 15+ */
/* iOS 16+ - All fixes are compatible with iOS 16+ */
/* iOS 17+ - All fixes are compatible with iOS 17+ */

/* iOS version-specific fixes can be added here as needed */
@supports (-webkit-touch-callout: none) {
  /* Universal iOS fixes that work across all versions */
  .ios-compatible {
    /* Ensure smooth scrolling */
    -webkit-overflow-scrolling: touch;
    
    /* Prevent text size adjustment */
    -webkit-text-size-adjust: 100%;
    
    /* Enable hardware acceleration */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
}
